<meta charset="UTF-8">
<div class="fullBody">
  <span class="title">Formatar</span>
  <div class="container">
    <textarea class="large-area large-area--input" placeholder="Insira o JSON aqui..."></textarea>
    <div class="controls">
      <button type="button" class="controls__button controls__button--format">Format</button>
      <button type="button" class="controls__button controls__button--minify">Minify</button>
    </div>
    <textarea readonly class="large-area large-area--output" placeholder="..."></textarea>
  </div>
  <span class="title">Hist√≥rico</span>
  <div class="history" id="history">
  </div>
</div>

<style>
  .fullBody {
    height: 100%;
    padding: 10px;
  }

  .history>div {
    position: relative;
    min-height: 250px;
  }

  .historyLabel {
    position: absolute;
    top: 0;
    left: 0;
    color: #ffffff;
    font-weight: bold;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  }

  .copyButton {
    position: absolute;
    bottom: 0;
    left: 0;
    padding: 8px;
    margin-bottom: 10px;
    margin-left: 10px;
    border-radius: 5px;
    border: none;
    outline: none;
    cursor: pointer;
    background: #6699ff;
    color: #ffffff;
    font-weight: bold;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  }

  .title {
    margin-top: 10px;
    margin-bottom: 10px;
    border-radius: 5px;
    border: none;
    outline: none;
    color: #ffffff;
    font-weight: bold;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    padding: 20px;
  }

  .history {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    align-items: center;
    height: 48%;
    min-height: 48%;
    box-sizing: border-box;
    padding: 20px;
    gap: 20px;
  }

  body {
    margin: 0;
    background: #333333;
  }

  .container {
    display: grid;
    grid-template-columns: 1fr 100px 1fr;
    align-items: center;
    height: 50%;
    min-height: 250px;
    box-sizing: border-box;
    padding: 20px;
    gap: 20px;
  }

  .large-area {
    height: 100%;
    width: 100%;
    padding: 20px;
    box-sizing: border-box;
    color: #aaaaaa;
    background: #444444;
    border: none;
    border-radius: 10px;
    outline: none;
    resize: none;
    font-family: monospace;
    transition: background 0.25s, color 0.25s;
  }

  .large-area:hover,
  .large-area:focus {
    background: #4a4a4a;
  }

  .large-area:focus {
    color: #eeeeee;
  }

  .controls__button {
    padding: 8px 14px;
    width: 100%;
    margin-bottom: 10px;
    border-radius: 5px;
    border: none;
    outline: none;
    cursor: pointer;
    background: #6699ff;
    color: #ffffff;
    font-weight: bold;
    font-family: "Roboto";
  }

  .controls__button:active {
    background: #00705a;
  }
</style>

<script>
  const inputArea = document.querySelector(".large-area--input");
  const outputArea = document.querySelector(".large-area--output");
  const btnFormat = document.querySelector(".controls__button--format");
  const btnMinify = document.querySelector(".controls__button--minify");
  const btnCopy = document.getElementsByClassName(".copyButton")
  const historyhtml = "<div><label for='#counter' class='historyLabel'>#counter</label><textarea readonly class='large-area large-area--output' id='#counter'>output</textarea><button class='copyButton' onclick='copy(counter)'>Copy</button></div>"
  let counter = 1;

  document.addEventListener("DOMContentLoaded", function () {
    document.getElementById('history').innerHtml = "";
  });


  btnFormat.addEventListener("click", () => {
    if (inputArea.value == "") {
      alert("Preencha o campo com o JSON");
      return;
    }
    try {
      const formatted = JSON.stringify(JSON.parse(inputArea.value), null, 4);

      outputArea.value = formatted;

      addHistory(formatted);
    }
    catch (ex) {
      alert("Ocorreu um erro! --> " + ex);
    }
  });

  btnMinify.addEventListener("click", () => {
    try {
      const minified = JSON.stringify(JSON.parse(inputArea.value));

      outputArea.value = minified;

      addHistory(minified);
    }
    catch (ex) {
      alert("Ocorreu um erro! --> " + ex);
    }
  });

  function copy(id) {
    navigator.clipboard.writeText(document.getElementById("#" + id).value);
    alert("Copiado com sucesso!")
  }

  function addHistory(formatted) {
    let html = historyhtml
    html = html.replaceAll("output", formatted);
    html = html.replaceAll("counter", counter)

    document.getElementById('history').insertAdjacentHTML('afterbegin', html);
    counter++;
  }

</script>